<!DOCTYPE html>
<html>
  <head>
    <title>{% block title %}自動相機監測影像及資料管理系統{% endblock title %}</title>
    {% load static %}
    <link rel="icon" style="background-size: cover" href="{% static 'icon/logo@leaf.png' %}" />
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <link rel="stylesheet" href="{% static 'jquery-ui-1.12.1/jquery-ui.css' %}" />
    <script src="{% static 'jquery-ui-1.12.1/jquery-ui.js' %}"></script>
    <link href="https://cdn.datatables.net/1.11.0/css/jquery.dataTables.min.css" />
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.0/js/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/1.11.0/js/dataTables.bootstrap5.min.js"></script>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous" />-->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet" crossorigin="anonymous" />
    <link href="https://cdn.datatables.net/1.10.24/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/b8e586964f.js" crossorigin="anonymous"></script>
    {% block head %}{% endblock head %}
    <style type="text/css">
      .link:link {
        color: gray;
        cursor: pointer;
      }

      .link:visited {
        color: gray;
        background-color: transparent;
        text-decoration: none;
      }

      .link:hover {
        color: lightgrey;
        background-color: transparent;
        text-decoration: underline;
      }

      .link:active {
        color: gray;
        background-color: transparent;
        text-decoration: underline;
      }

      .notice {
        color: #c65454;
      }
      .notice-border {
        border-color: #c65454;
      }
      input[type="checkbox"]:checked {
        /*accent-color: #7c9c2d;*/
        filter: hue-rotate(215deg);
      }
      input[type="radio"]:checked {
        /*accent-color: #7c9c2d;*/
        filter: hue-rotate(215deg);
      }
      /* loader */

      .loader {
        content: "";
        position: fixed;
        z-index: 1000;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background: url("{% static  'icon/Leaves-1.8s-200px.gif' %}") no-repeat center;
      }

      .loader:after {
        content: "處理中";
        position: absolute;
        top: 200px;
        bottom: 0;
        left: 0;
        right: 0;
        color: rgb(37, 116, 85);
        width: 100px;
        height: 20px;
        margin: auto;
        z-index: 1199;
        text-align: center;
      }

      .loading {
        min-height: 400px;
      }

      .loading:before {
        content: "";
        position: absolute;
        top: -110px;
        bottom: 0;
        width: 100%;
        height: 400px;
        left: 0;
        right: 0;
        margin: auto;
        background: url("{% static  'icon/Leaves-1.8s-200px.gif' %}") no-repeat center;
        background-size: 150px;
        z-index: 1099;
      }

      .loading:after {
        content: "資料讀取中";
        position: absolute;
        top: 70px;
        bottom: 0;
        left: 0;
        right: 0;
        color: gray;
        width: 100px;
        height: 20px;
        margin: auto;
        z-index: 1199;
        text-align: center;
      }

      html,
      body {
        height: 100%;
        background: #f7f7f7;
      }

      .nav-link:focus {
        outline: 0;
      }

      .bg-gray {
        background: #f7f7f7;
      }

      .content {
        margin: 40px auto;
        min-height: -o-calc(100vh - 400px); /* opera */
        min-height: -webkit-calc(100vh - 400px); /* google, safari */
        min-height: -moz-calc(100vh - 400px); /* firefox */
      }

      .image {
        text-align: center;
      }

      img.image {
        width: 222px;
        margin: 0 auto;
      }

      .text-green {
        color: rgb(37, 116, 85);
      }

      .btn-orange {
        background-color: darkorange;
        color: white;
      }

      .btn-orange:hover {
        background-color: rgb(255, 111, 0);
        color: white;
      }

      .title-dark {
        /*color: #198754;*/
        color: rgb(37, 116, 85);
      }

      .title-light {
        color: #7c9c2d;
      }

      .backgroud-dark {
        background-color: rgb(37, 116, 85);
      }

      .description {
        font-size: 24px;
        margin: 0;
        color: gray;
        font-weight: 400;
      }

      hr.home-hr {
        border: 0;
        border-top: 3px solid green;
        width: 170px;
        margin: 5px auto;
      }

      .required {
        display: inline-block;
        margin-right: 5px;
        color: #dc3545;
      }

      /* tooltip */
      .tooltip {
        font-size: 16px;
        width: 400px;
      }

      .tooltip-inner {
        max-width: 100% !important;
        text-align: left;
        text-align: start;
      }

      /* footer */
      footer .container {
        padding: 40px 0;
      }

      .gov-item img {
        height: 27px;
        width: auto;
        margin-right: 5px;
      }

      .text-gray {
        color: gray;
      }

      span.gov-item {
        margin-left: 15px;
        display: inline-block;
        vertical-align: middle;
        margin-bottom: 15px;
        color: #fff;
      }

      img.gov-logo {
        vertical-align: middle;
      }

      span.text {
        vertical-align: middle;
        text-align: left;
        display: inline-block;
        font-size: 14px;
        font-weight: 300;
      }

      small {
        display: block;
        font-size: 11px;
      }

      .sitemap {
        display: flex;
        flex-direction: row;
      }

      .item {
        flex: 1;
        font-size: 14px;
      }

      .item label {
        height: 40px;
        line-height: 40px;
      }

      .item ul {
        margin: 0;
        padding: 0;
        list-style: none;
      }

      .item li a {
        color: #fff;
        font-weight: 300;
        line-height: 30px;
        height: 30px;
        text-decoration: none;
      }

      .icon {
        display: inline-block;
        vertical-align: middle;
      }

      .icon-phone-gray {
        background-image: url("{% static 'icon/icons-sa4ae1ae68a.png' %}");
        background-position: 0 -878px;
        background-repeat: no-repeat;
        overflow: hidden;
        display: inline-block;
        height: 18px;
        width: 18px;
      }
      @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {
        .icon-phone-gray {
          background-repeat: no-repeat;
          background-image: url("{% static 'icon/icons-2x-sb27373e813.png' %}");
          background-size: 53px 1401px;
          background-position: 0 -823px;
          height: 19px;
          width: 19px;
        }
      }

      .icon-mail-gray {
        background-image: url("{% static 'icon/icons-sa4ae1ae68a.png' %}");
        background-position: 0 -774px;
        background-repeat: no-repeat;
        overflow: hidden;
        display: inline-block;
        height: 18px;
        width: 18px;
      }
      @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {
        .icon-mail-gray {
          background-repeat: no-repeat;
          background-image: url("{% static 'icon/icons-2x-sb27373e813.png' %}");
          background-size: 53px 1401px;
          background-position: 0 -725px;
          height: 19px;
          width: 19px;
        }
      }
    </style>
    {% block style %}{% endblock style %}
  </head>

  <body>
    <nav class="navbar navbar-expand-lg navbar-dark" style="background: linear-gradient(to right, #006a58, #9ccc65)">
      <div class="container">
        <a class="navbar-brand" href="{% url 'home' %}">
          <img src="{% static 'icon/logo@2x.png' %}" width="200" height="auto" alt="" />
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="{% url 'project_overview' %}">計畫總覽</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="{% url 'search' %}">資料篩選與計算</a>
            </li>
            <!-- <li class="nav-item">
                <a class="nav-link" href="#">上傳紀錄</a>
              </li>-->
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false"> 幫助 </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                <li><a class="dropdown-item" href="{% url 'faq' %}">常見問題</a></li>
                <li><a class="dropdown-item" href="{% url 'contact-us' %}">聯絡我們</a></li>
                <li><a class="dropdown-item" href="{% url 'policy' %}">隱私權政策</a></li>
              </ul>
            </li>
          </ul>
        </div>
        <div class="navbar-nav">
          <div class="nav-item">
            <!-- Button trigger modal -->
            {% if not request.session.is_login %}
            <a class="btn btn-orange" data-bs-toggle="modal" data-bs-target="#loginModal">登入</a>
            {% else %}
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle active" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false"> {{ request.session.name }} </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="{% url 'personal_info' %}">帳號設定</a></li>
                {% comment %} {% if request.session.name in '系統管理員,計畫總管理人' %} {% endcomment %} {% if request.session.name == '系統管理員' %}
                <li><a class="dropdown-item" href="{% url 'set_permission' %}">權限管理</a></li>
                {% endif %}
                <li><a class="dropdown-item" href="{% url 'logout' %}">登出</a></li>
              </ul>
            </li>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>
    {% for message in messages %}
    <div class="container" style="margin-top: 30px">
      <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    </div>
    {% endfor %} {% block body %} {% endblock body %}

    <!-- Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title title-dark" id="loginModalLabel">登入</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>請使用您的 ORCID 帳號登入：</p>
            <div class="my-3">
              <a class="btn btn-light w-100" onClick="getAuth()"> 使用 ORCID 帳號登入 </a>

              ＊測試用登入＊<br />
              <a class="btn btn-light" href="{% url 'login_for_test' %}?role=計畫總管理人&next={{ request.path }}"> 計畫總管理人 </a>
              <a class="btn btn-light" href="{% url 'login_for_test' %}?role=個別計畫承辦人&next={{ request.path }}"> 計畫承辦人 </a>
              <a class="btn btn-light" href="{% url 'login_for_test' %}?role=資料上傳者&next={{ request.path }}"> 資料上傳者 </a>
              <a class="btn btn-light" href="{% url 'login_for_test' %}?role=系統管理員&next={{ request.path }}"> 系統管理員 </a>
            </div>
            <div class="text-gray">
              還沒有帳號？
              <a href="https://orcid.org/register" class="text-green" target="_blank">
                前往
                <i class="icon align-baseline icon-orcid-text"></i> 網頁註冊
              </a>
            </div>
            <hr class="mt-5" />
            <div class="text-center">
              當您登入系統，即代表您同意我們的
              <a href="{% url 'policy' %}" class="text-green">隱私權保護政策</a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="text-center text-lg-start mt-auto" style="background: #2e432b">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-4 text-center pt-4">
            <img src="{% static 'icon/logo@2x.png' %}" style="width: 70%" />
            <div class="mt-2">
              <small class="text-gray">
                Copyright © 2021 Forestry Bureau<br />
                行政院農業委員會林務局 版權所有
              </small>
            </div>
          </div>
          <div class="col-xs-12 col-sm-12 col-md-8">
            <div class="sitemap">
              <div class="item">
                <label class="text-gray">相關連結</label>
                <ul>
                  <li>
                    <a href="https://www.forest.gov.tw" target="_blank"> 林務局網站 </a>
                  </li>
                  <li>
                    <a href="https://www.tesri.gov.tw" target="_blank"> 特有生物研究保育中心 </a>
                  </li>
                  <li>
                    <a href="https://portal.taibif.tw" target="_blank"> 台灣生物多樣性資訊入口網 </a>
                  </li>
                  <li>
                    <a href="https://wp.npust.edu.tw" target="_blank"> 國立屏東科技大學 </a>
                  </li>
                </ul>
              </div>
              <div class="item">
                <label class="text-gray">幫助</label>
                <ul>
                  <!--
                  <li>
                    <a href="/article.html#/faq" target="_blank"> 常見問題 </a>
                  </li>
                -->
                  <li>
                    <a href="{% url 'policy' %}" target="_blank"> 隱私權聲明及使用條款 </a>
                  </li>
                </ul>
              </div>
              <div class="item">
                <label class="text-gray">聯絡我們</label>
                <ul>
                  <li>
                    <a href="mailto:cameratrap.taibif@gmail.com" target="_blank">
                      <i class="icon icon-mail-gray"></i>
                      <span class="text">cameratrap.taibif@gmail.com</span>
                    </a>
                  </li>
                  <li>
                    <a href="tel:+886227899621" target="_blank">
                      <i class="icon icon-phone-gray"></i>
                      <span class="text">02-27899621</span>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-12">
            <hr />
            <small class="text-center d-block">
              <span class="text-gray">主辦機關：</span>
              <span class="gov-item">
                <img class="gov-logo" src="{% static 'icon/logo-forest@2x.png' %}" />
                <span class="text">
                  <small>行政院農委會</small>
                  林 務 局
                </span>
              </span>
              <span class="gov-item">
                <img class="gov-logo" src="{% static 'icon/logo-tesri@2x.png' %}" />
                <span class="text">
                  <small>行政院農委會</small>
                  特有生物研究保育中心
                </span>
              </span>
              <span class="gov-item">
                <img class="gov-logo" src="{% static 'icon/logo-taibif.png' %}" />
                <span class="text"> 台灣生物多樣性資訊入口網 </span>
              </span>
              <span class="gov-item">
                <img class="gov-logo" src="{% static 'icon/logo-npust.png' %}" />
                <span class="text"> 國立屏東科技大學 </span>
              </span>
            </small>
          </div>
        </div>
      </div>
    </footer>
    <!-- script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8" crossorigin="anonymous"></script-->
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>

    <script>
      $(document).ready(function () {
        $("li.active").removeClass("active");
        $('a[href="' + location.pathname + '"]')
          .closest(".nav-link")
          .addClass("active");
      });

      // tooltip
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
      var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
      });

      function getAuth() {
        let url = "https://orcid.org/oauth/authorize?client_id=APP-F6POVPAP5L1JOUN1&response_type=code&scope=/authenticate&redirect_uri=" + location.protocol + "//" + location.host + "/callback/orcid/auth?next={{ request.path }}";
        window.location.href = url;
      }
    </script>
    {% block script %} {% endblock script %}
  </body>
</html>
